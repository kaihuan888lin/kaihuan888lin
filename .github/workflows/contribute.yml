# This is a basic workflow that is manually triggered
name: Metrics
on:
  # Schedule updates (each hour)
  schedule: [{cron: "0 * * * *"}]
  # Lines below let you run workflow manually and on each commit
  workflow_dispatch:
  push: {branches: ["master", "main"]}
jobs:
  github-metrics:
    runs-on: ubuntu-latest
    environment: 
      name: production
    permissions:
      contents: write

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
    # Runs a single command using the runners shell
    - name: Contributors by categories
      uses: lowlighter/metrics@latest
      with:
        filename: metrics.plugin.contributors.categories.svg
        token: ${{ secrets.METRICS_TOKEN }}
        base: ""
        template: repository
        repo: metrics
        plugin_contributors: yes
        plugin_contributors_sections: categories
        plugin_contributors_categories: |
          {
            "üñºÔ∏è bin":["bin/**"],
            "üìö Documentation":["README.md", "**/README.md", "**/metadata.yml"],
            "üíª Code (other)":["/adam/**", "/perf/**"]
          }


